# -*- coding: utf-8 -*-
"""linear_regression

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1P1_kVAyn_3AhNF17aRHJm_QI0g2tjUZ_
"""

from init import *
from custom_metrics import *

def lr_pred(df_train, df_test, train_cols):
    '''Run Linear Regression Model pipeline. 
    Returns the following: RMSE, Accuracy, Predictions, 
                           True Values, Model, Train Set'''

    X_train = df_train[train_cols]
    y_train = df_train['target']
    X_test = df_test[train_cols]
    y_test = df_test['target']

    lr = LinearRegression()

    lr.fit(X_train, y_train)

    y_pred = lr.predict(X_test)
    
    rmse = mean_squared_error(y_test, y_pred) ** 0.5
    acc = pred_accuracy(y_test, y_pred)
    
    return rmse, acc, y_pred, y_test, lr, X_train